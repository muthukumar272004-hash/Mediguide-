medi_guide_plus/
├─ backend/
│  ├─ main.py
│  ├─ sample_data.py
│  ├─ gemini_client.py
│  ├─ vision_client.py
│  ├─ requirements.txt
│  └─ .env               # create locally, do NOT commit
└─ frontend/
   ├─ package.json
   ├─ public/
   │  └─ index.html
   └─ src/
      ├─ index.js
      ├─ App.jsx
      ├─ styles.css
      └─ components/
         ├─ ChatBox.jsx
         └─ PharmacyList.jsx
      └─ assets/
         └─ mediguide_logo.png  <-- use the logo file path below
# backend/main.py
from fastapi import FastAPI, UploadFile, File
from pydantic import BaseModel
import uvicorn
from typing import List
from sample_data import PILLS_DB, PHARMACIES_DB
from gemini_client import query_gemini
from vision_client import detect_image_labels

app = FastAPI(title="MediGuide+ Backend (Week 4 Prototype)")

class ChatRequest(BaseModel):
    user_id: str = "anon"
    message: str

class SearchRequest(BaseModel):
    pill_name: str
    lat: float = None
    lng: float = None
    radius_m: int = 2000

@app.get("/")
def root():
    return {"status": "MediGuide+ backend running"}

@app.post("/chat")
async def chat_endpoint(req: ChatRequest):
    """
    Forward user message to Gemini LLM (or fallback).
    """
    prompt = f"You are MediBoy, a friendly medical assistant. User: {req.message}\nAnswer briefly and safely and recommend consulting a doctor when appropriate."
    try:
        reply = query_gemini(prompt)
    except Exception as e:
        print("Gemini error:", e)
        reply = "AI currently unavailable. Please search the pill or consult a healthcare professional."
    return {"reply": reply}

@app.post("/search-medicine")
async def search_medicine(req: SearchRequest):
    """
    Basic local search to return pill info & sample pharmacy list.
    """
    pill_key = req.pill_name.strip().lower()
    pill_matches = [p for p in PILLS_DB if pill_key in p["name"].lower()]
    pill_info = pill_matches[0] if pill_matches else {"name": req.pill_name, "notes": "No local info available."}
    shops = PHARMACIES_DB[:10]
    return {"pill": pill_info, "pharmacies": shops}

@app.post("/scan")
async def scan_tablet(file: UploadFile = File(...)):
    content = await file.read()
    try:
        labels = detect_image_labels(content)
    except Exception as e:
        print("Vision error:", e)
        labels = []
    matched = None
    text = " ".join(labels).lower()
    for p in PILLS_DB:
        if p["name"].lower() in text or any(alias.lower() in text for alias in p.get("aliases", [])):
            matched = p
            break
    return {"labels": labels, "matched_pill": matched}

if __name__ == "__main__":
    uvicorn.run("main:app", host="0.0.0.0", port=8000, reload=True)
# backend/sample_data.py
PILLS_DB = [
    {"id": 1, "name": "Paracetamol 500mg", "composition": "Acetaminophen", "dosage": "1-2 tablets every 4-6 hours", "precautions": "Do not exceed 4g per day. Consult doctor if liver disease.", "aliases": ["acetaminophen", "paracetamol"]},
    {"id": 2, "name": "Ibuprofen 200mg", "composition": "Ibuprofen", "dosage": "1 tablet every 6-8 hours", "precautions": "Take after food. Avoid in peptic ulcers.", "aliases": ["ibuprofen", "advil", "motrin"]},
]

PHARMACIES_DB = [
    {"id": "ph1", "name": "Apollo Pharmacy", "address": "123 Main St", "phone": "+91-1111111111", "open_until": "22:00", "distance_km": 1.2, "offers": "10% off"},
    {"id": "ph2", "name": "A1 Medicals", "address": "45 Oak Rd", "phone": "+91-2222222222", "open_until": "21:00", "distance_km": 0.6, "offers": "5% off"},
    {"id": "ph3", "name": "Hillside Pharmacy", "address": "7 Hill Lane", "phone": "+91-3333333333", "open_until": "23:00", "distance_km": 2.1, "offers": "No offers"},
]
# backend/gemini_client.py
import os
import requests

GEMINI_API_KEY = os.getenv("GEMINI_API_KEY")

def query_gemini(prompt: str, model: str = "gemini-1.5-pro"):
    if not GEMINI_API_KEY:
        raise RuntimeError("GEMINI_API_KEY not set in environment")
    # Example REST call — adapt to the current Gen AI endpoint/SDK as per docs
    url = "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateText"
    headers = {"Content-Type": "application/json"}
    payload = {
        "prompt": {"text": prompt},
        "temperature": 0.2,
        "maxOutputTokens": 300
    }
    params = {"key": GEMINI_API_KEY}
    r = requests.post(url, headers=headers, json=payload, params=params, timeout=30)
    r.raise_for_status()
    j = r.json()
    # Parse response (adjust depending on actual response schema)
    if "candidates" in j and len(j["candidates"])>0:
        return j["candidates"][0].get("content", "")
    if "output" in j and "text" in j["output"]:
        return j["output"]["text"]
    return str(j)
# backend/vision_client.py
import os
import base64
import requests

GOOGLE_VISION_API_KEY = os.getenv("GOOGLE_VISION_API_KEY")

def detect_image_labels(image_bytes: bytes):
    if not GOOGLE_VISION_API_KEY:
        raise RuntimeError("GOOGLE_VISION_API_KEY not set")
    url = f"https://vision.googleapis.com/v1/images:annotate?key={GOOGLE_VISION_API_KEY}"
    b64 = base64.b64encode(image_bytes).decode("utf-8")
    body = {
        "requests": [
            {
                "image": {"content": b64},
                "features": [{"type": "LABEL_DETECTION", "maxResults": 10}]
            }
        ]
    }
    res = requests.post(url, json=body, timeout=30)
    res.raise_for_status()
    data = res.json()
    labels = []
    for r in data.get("responses", []):
        for la in r.get("labelAnnotations", []):
            labels.append(la.get("description"))
    return labels
fastapi
uvicorn[standard]
requests
pydantic
python-dotenv
GEMINI_API_KEY=YOUR_GEMINI_API_KEY
GOOGLE_VISION_API_KEY=YOUR_GOOGLE_VISION_API_KEY
{
  "name": "mediguide-frontend",
  "version": "0.1.0",
  "private": true,
  "dependencies": {
    "axios": "^1.4.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-scripts": "5.0.1"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build"
  }
}
import React from "react";
import { createRoot } from "react-dom/client";
import App from "./App";
import "./styles.css";

createRoot(document.getElementById("root")).render(<App />);
body { font-family: Arial, sans-serif; margin:0; background:#f3f6fb; }
.container { max-width:1100px; margin:40px auto; padding:20px; display:flex; gap:20px; }
.sidebar { width:360px; background:#fff; padding:16px; border-radius:10px; box-shadow: 0 2px 10px rgba(0,0,0,0.06); }
.main { flex:1; background:#fff; padding:16px; border-radius:10px; box-shadow: 0 2px 10px rgba(0,0,0,0.06); }
.logo { width:200px; display:block; margin:0 auto 10px; }
h2 { color:#174a92; margin-bottom:8px; }
button.primary { background:#1c8f3a; color:#fff; border:none; padding:10px 14px; border-radius:8px; cursor:pointer; }
import React, { useState } from "react";
import axios from "axios";
import ChatBox from "./components/ChatBox";
import PharmacyList from "./components/PharmacyList";
import logoPath from "../logo_path_helper";

function App() {
  const [pill, setPill] = useState("");
  const [pharmacies, setPharmacies] = useState([]);
  const [chatMessages, setChatMessages] = useState([{ from: "bot", text: "Hi I am MediBoy — ask me about medicines or nearby pharmacies." }]);

  const sendChat = async (message) => {
    setChatMessages(s => [...s, { from: "user", text: message }]);
    try {
      const res = await axios.post("http://localhost:8000/chat", { user_id: "web1", message });
      const reply = res.data.reply || "No response";
      setChatMessages(s => [...s, { from: "bot", text: reply }]);
    } catch (err) {
      setChatMessages(s => [...s, { from: "bot", text: "Server error. Try again later." }]);
    }
  };

  const findPharmacies = async () => {
    if (!pill) return alert("Enter pill name");
    try {
      const res = await axios.post("http://localhost:8000/search-medicine", { pill_name: pill });
      setPharmacies(res.data.pharmacies || []);
    } catch (err) {
      alert("Error fetching pharmacies");
    }
  };

  return (
    <div className="container">
      <div className="sidebar">
        <img src={logoPath} alt="MediGuide+ Logo" className="logo" />
        <h2>MediGuide+</h2>
        <input placeholder="Search pill..." value={pill} onChange={(e)=>setPill(e.target.value)} style={{width:"100%", padding:10, marginBottom:8}} />
        <button className="primary" onClick={findPharmacies} style={{width:'100%'}}>Find pharmacies</button>
        <PharmacyList shops={pharmacies} />
      </div>

      <div className="main">
        <ChatBox messages={chatMessages} onSend={sendChat} />
      </div>
    </div>
  );
}

export default App;
import React, { useState, useRef, useEffect } from "react";

export default function ChatBox({ messages, onSend }) {
  const [text, setText] = useState("");
  const bottomRef = useRef();

  useEffect(()=> bottomRef.current?.scrollIntoView({ behavior:"smooth" }), [messages]);

  const submit = () => {
    if (!text.trim()) return;
    onSend(text.trim());
    setText("");
  };

  return (
    <div style={{display:"flex", flexDirection:"column", height:"70vh"}}>
      <div style={{flex:1, overflowY:"auto", padding:8}}>
        {messages.map((m,i)=>(
          <div key={i} style={{marginBottom:8, display:"flex", justifyContent: m.from==="user" ? "flex-end" : "flex-start"}}>
            <div style={{background: m.from==="user" ? "#cfe9ff":"#eee", padding:10, borderRadius:8, maxWidth:"75%"}}>
              {m.text}
            </div>
          </div>
        ))}
        <div ref={bottomRef} />
      </div>

      <div style={{display:"flex", gap:8}}>
        <input value={text} onChange={(e)=>setText(e.target.value)} onKeyDown={(e)=>e.key==="Enter" && submit()} style={{flex:1, padding:10}} placeholder="Type message..." />
        <button onClick={submit} style={{padding:"10px 14px"}}>Send</button>
      </div>
    </div>
  );
}
import React from "react";

export default function PharmacyList({ shops }) {
  if (!shops || shops.length === 0) return <div style={{marginTop:20}}>No pharmacies yet. Search a pill to see results.</div>;
  return (
    <div style={{marginTop:16}}>
      <h4>Nearby Pharmacies</h4>
      {shops.map(s => (
        <div key={s.id} style={{border:"1px solid #eee", padding:10, borderRadius:8, marginBottom:8}}>
          <div style={{fontWeight:600}}>{s.name}</div>
          <div style={{fontSize:13}}>{s.address} • {s.distance_km} km</div>
          <div style={{fontSize:13, color:"#333"}}>Open until {s.open_until} • {s.offers}</div>
        </div>
      ))}
    </div>
  );
}
// frontend/src/logo_path_helper.js
// For local dev we will reference the logo file path provided earlier.
// You should copy the file from the server path to frontend/src/assets/mediguide_logo.png
// OR use the path directly if the environment lets you serve it.
// Provided logo path on this environment:
export default "/mnt/data/A_logo_for_\"MediGuide\"_is_displayed_on_a_white_ba.png";
cd medi_guide_plus/backend
python -m venv venv
source venv/bin/activate   # on Windows: venv\Scripts\activate
pip install -r requirements.txt
pip install python-dotenv
GEMINI_API_KEY=your_gemini_key
GOOGLE_VISION_API_KEY=your_vision_key
cd medi_guide_plus/frontend
npm install
npm start
/mnt/data/A_logo_for_"MediGuide+"_is_displayed_on_a_white_ba.png
